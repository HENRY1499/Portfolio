---
import LabelAtom from "../atoms/LabelAtom.astro";
import InputAtom from "../atoms/InputAtom.astro";
import ButtonAtom from "../atoms/ButtonAtom.astro";
---

<form
  id="onSubmit"
  class="xl:w-11/12 md:w-full xl:gap-8 xl:p-8 flex flex-col border-2 border-dashed border-thirty rounded-xl gap-4 p-4"
>
  <div class="w-full flex flex-col gap-4">
    <LabelAtom title={"Nombre Completo"} />
    <InputAtom
      name={"name"}
      placeholder={"EJ: Carlos Acantara Llanos Rogue"}
      type="text"
    />
  </div>
  <div class="sm:flex-row w-full flex flex-col gap-4">
    <div class="w-full flex flex-col gap-4">
      <LabelAtom title={"Correo Electrónico"} />
      <InputAtom
        name={"email"}
        placeholder={"EJ: Carlos@gmail.com"}
        type="email"
      />
    </div>
    <div class="w-full flex flex-col gap-4">
      <LabelAtom title={"WhatsApp"} />
      <InputAtom name={"whatsapp"} placeholder={"EJ: 922516022"} type="text" />
    </div>
  </div>
  <div class="w-full h-full flex flex-col gap-4">
    <LabelAtom title={"Mensaje"} />
    <textarea
      required
      name="message"
      class="lg:text-sm flex-1 text-xs font-[OpenSansLight] bg-white rounded-[.4rem] px-4 py-2 outline-none focus:outline-2 focus:ring-2 focus:ring-[#C49381]"
      placeholder="Escribe tu mensaje..."></textarea>
  </div>
  <ButtonAtom
    type={"submit"}
    title={"Enviar"}
    style="rounded-[.8rem] justify-center"
  >
    <span
      class="text-cta-label font-[MontserratBold] text-sm tracking-widest group-hover:text-cta-hover-label"
      >{"Enviar"}</span
    >
  </ButtonAtom>
</form>
<script is:inline>
  const form = document.getElementById("onSubmit");
  form?.addEventListener("submit", (e) => {
    e.preventDefault();
    const formData = new FormData(form);
    fetch("/api/contact", {
      method: "POST",
      body: formData,
    })
      .then((response) => {
        if (response.ok) {
          alert("Mensaje enviado con éxito");
          form.reset();
        } else {
          alert("Error al enviar el mensaje");
        }
      })
      .catch(() => {
        alert("Error al enviar el mensaje");
      });
  });
</script>
